!function(e){var t=function(t){var n=this;t=t||{},"string"==typeof t&&(t={elements:t}),this.text=t.text||"",this.sel=null,this.textSelection="",this.htmlSelection="",this.postId=null,this.appId=e('meta[property="fb:app_id"]').attr("content")||e('meta[property="fb:app_id"]').attr("value"),this.url2share=e('meta[property="og:url"]').attr("content")||e('meta[property="og:url"]').attr("value")||window.location.href,this.getSelectionText=function(t){var o="",a="",t=t||window.getSelection();if(t.rangeCount>0){{t.getRangeAt(0)}if(t.rangeCount){for(var r=document.createElement("div"),s=0,i=t.rangeCount;i>s;++s)r.appendChild(t.getRangeAt(s).cloneContents());a=r.textContent,o=r.innerHTML}n.textSelection=a,n.htmlSelection=o||a;var c=e(t.anchorNode).parents("article"),l=null;if(c.length){var d=c.attr("class").match(/post-(\d+)/);d&&(l=d[1])}n.postId=l}return a},this.selectionDirection=function(e){var t=e||window.getSelection(),n=document.createRange();if(!t.anchorNode)return 0;n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset);var o=n.collapsed?"backward":"forward";return n.detach()&&n.detach(),o},this.showPopunder=function(e,t){if(t||(t=!1),n.popunder=n.popunder||document.getElementById("selectionSharerPopunder"),n.popunder)return void n.hide(n.popunder);var o=window.getSelection(),a=n.getSelectionText(o);if(o.isCollapsed||a.length<10||!a.match(/ /))return n.hidePopunder();if(n.popunder.classList.contains("fixed"))return n.popunder.style.bottom=0;var r=o.getRangeAt(0),s=window.getSelection().anchorNode.parentElement.localName;if(t){var i=document.createElement("span");i.className="shared";var c=document.createElement("span");c.className="sharedSharesTwitter";var l=document.createElement("span");l.className="sharedSharesFacebook";var d=document.createElement("span");d.className="sharedSharesLinkedIn";var h=document.createElement("span");h.className="sharedSharesEmail","p"==s&&(r.surroundContents(i),jQuery(".shared").each(function(){0==jQuery(".sharedSharesTwitter",this).length&&(jQuery(c).appendTo(this),jQuery(l).appendTo(this),jQuery(d).appendTo(this),jQuery(h).appendTo(this))}))}var u=r.endContainer.parentNode;if(n.popunder.classList.contains("show")){if(Math.ceil(n.popunder.getBoundingClientRect().top)==Math.ceil(u.getBoundingClientRect().bottom))return;return n.hidePopunder(n.showPopunder)}if(u.nextElementSibling)n.pushSiblings(u);else{n.placeholder||(n.placeholder=document.createElement("div"),n.placeholder.className="selectionSharerPlaceholder");var p=window.getComputedStyle(u).marginBottom;n.placeholder.style.height=p,n.placeholder.style.marginBottom=-2*parseInt(p,10)+"px",u.parentNode.insertBefore(n.placeholder)}var m=window.pageYOffset+u.getBoundingClientRect().bottom;n.popunder.style.top=Math.ceil(m)+"px",setTimeout(function(){n.placeholder&&n.placeholder.classList.add("show"),n.popunder.classList.add("show")},0)},this.pushSiblings=function(e){for(;e=e.nextElementSibling;)e.classList.add("selectionSharer"),e.classList.add("moveDown")},this.hidePopunder=function(e){if(e=e||function(){},jQuery(".inboundrocket-ss-branding").hide(),jQuery("p.getSelectionText").find("span").contents().unwrap(),jQuery("p.selectionShareable").find("span").remove(),"fixed"==n.popunder)return n.popunder.style.bottom="-50px",e();n.popunder.classList.remove("show"),n.placeholder&&n.placeholder.classList.remove("show");for(var t=document.getElementsByClassName("moveDown");el=t[0];)el.classList.remove("moveDown");setTimeout(function(){n.placeholder&&document.body.insertBefore(n.placeholder),e()},600)},this.show_text=function(e){n.popunder=n.popunder||document.getElementById("selectionSharerPopunder"),n.popunder&&n.hide(n.popunder),jQuery(".inboundrocket-ss-branding").fadeIn(),n.$popover.removeClass("anim").css("top",e.pageY).css("left",e.pageX).show(),setTimeout(function(){n.$popover.addClass("anim").css("top",e.pageY-n.$popover.height()-10)},0)},this.show=function(e,t){t||(t=!1);var o=window.getSelection(),a=n.getSelectionText(o);if(!o.isCollapsed&&a&&a.length>10&&a.match(/ /)){var r=o.getRangeAt(0),s=window.getSelection().anchorNode.parentElement.localName;if(t){var i=document.createElement("span");i.className="shared";var c=document.createElement("span");c.className="sharedSharesTwitter";var l=document.createElement("span");l.className="sharedSharesFacebook";var d=document.createElement("span");d.className="sharedSharesLinkedIn";var h=document.createElement("span");h.className="sharedSharesEmail","p"==s&&(r.surroundContents(i),jQuery(".shared").each(function(){0==jQuery(".sharedSharesTwitter",this).length&&(jQuery(c).appendTo(this),jQuery(l).appendTo(this),jQuery(d).appendTo(this),jQuery(h).appendTo(this))}))}var u=r.getBoundingClientRect().top-5,p=u+window.scrollY-n.$popover.height(),m=r.getBoundingClientRect().left;switch(e&&(m=e.pageX),n.selectionDirection(o)){case"forward":m-=n.$popover.width();break;case"backward":m+=n.$popover.width()}jQuery(".inboundrocket-ss-branding").fadeIn(),n.$popover.removeClass("anim").css("top",p+10).css("left",m).show(),setTimeout(function(){n.$popover.addClass("anim").css("top",p)},0)}},this.hide=function(){var e=window.getSelection&&window.getSelection();if(e&&e.rangeCount>0){var t=e.getRangeAt(0),n=t.startContainer.firstChild?t.startContainer.firstChild:!1;n||(jQuery("#selectionSharerPopover").hide(),jQuery(".inboundrocket-ss-branding").hide())}},this.smart_truncate=function(e,t){if(!e||!e.length)return e;var n=e.length>t,o=n?e.substr(0,t-1):e;return o=n?o.substr(0,o.lastIndexOf(" ")):o,n?o+"...":o},this.getRelatedTwitterAccounts=function(){var t=[],n=e('meta[name="twitter:creator"]').attr("content")||e('meta[name="twitter:creator"]').attr("value");n&&t.push(n);for(var o=document.getElementsByTagName("a"),a=0,r=o.length;r>a;a++)if(o[a].attributes.href&&"string"==typeof o[a].attributes.href.value){var s=o[a].attributes.href.value.match(/^https?:\/\/twitter\.com\/([a-z0-9_]{1,20})/i);s&&s.length>1&&-1==["widgets","intent"].indexOf(s[1])&&t.push(s[1])}return t.length>0?t.join(","):""},this.updateShareCount=function(t,n,o){e.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_track",postid:t,text:n,type:o}})},this.shareTwitter=function(t){t.preventDefault(),n.viaTwitterAccount||(n.viaTwitterAccount=e('meta[name="twitter:site"]').attr("content")||e('meta[name="twitter:site"]').attr("value")||"",n.viaTwitterAccount=n.viaTwitterAccount.replace(/@/,"")),n.relatedTwitterAccounts||(n.relatedTwitterAccounts=n.getRelatedTwitterAccounts());var o,a,r,s,i,c=null;jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",async:!1,dataType:"json",data:{url:location.href,type:"twitter",nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_shorturl"},success:function(e){c=e.shorturl}}),jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",async:!1,dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_settings"},success:function(e){if(o=n.textSelection.trim(),o||(o=n.text),s="",e.ir_ss_twitter_username&&(i=" via @"+e.ir_ss_twitter_username),e.ir_ss_tweet_suffix&&(s+=" "+e.ir_ss_tweet_suffix),r="",o.length<140&&null!=s&&void 0!==i?r=i+s:null!=s&&void 0===i?r=s:void 0!=i&&(r=i),o.length>140&&null==r)a=n.smart_truncate(o,120);else if(o.length>140&&null!=r){{o.length-(o.length-r.length)}a=n.smart_truncate(o,114)}else o.length<140&&null!=r?a=n.smart_truncate(o,120):o.length<140&&null==r&&(a=n.smart_truncate(o,114));a+=r}});var l="http://twitter.com/intent/tweet?text="+encodeURIComponent(a)+"&related="+n.relatedTwitterAccounts+"&url="+encodeURIComponent(c);n.viaTwitterAccount&&o.length<114-n.viaTwitterAccount.length&&(l+="&via="+n.viaTwitterAccount);var d=640,h=440,u=screen.width/2-d/2,p=screen.height/2-h/2-100;return window.open(l,"share_twitter","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+d+", height="+h+", top="+p+", left="+u),n.hide(),n.updateShareCount(n.postId,a,"twitter"),!1},this.shareFacebook=function(e){e.preventDefault();var t=n.htmlSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim(),o="https://www.facebook.com/dialog/feed?app_id="+n.appId+"&display=popup&caption="+encodeURIComponent(t)+"&link="+encodeURIComponent(n.url2share)+"&href="+encodeURIComponent(n.url2share)+"&redirect_uri="+encodeURIComponent(n.url2share),a=640,r=440,s=screen.width/2-a/2,i=screen.height/2-r/2-100;window.open(o,"share_facebook","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+r+", top="+i+", left="+s)},this.shareLinkedIn=function(e){e.preventDefault();var t=n.htmlSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim(),o="https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(n.url2share)+"&title="+encodeURIComponent(t),a=640,r=440,s=screen.width/2-a/2,i=screen.height/2-r/2-100;window.open(o,"share_linkedin","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+r+", top="+i+", left="+s)},this.shareEmail=function(){var e=null,t=n.htmlSelection.replace(/<p[^>]*>/gi,"\n").replace(/<\/p>|  /gi,"").trim();jQuery.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",async:!1,dataType:"json",data:{url:location.href,type:"email",nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_shorturl"},success:function(t){e=t.shorturl}});var o={};return o.subject=encodeURIComponent("Quote from "+document.title),o.body=encodeURIComponent("“"+t+"”")+"%0D%0A%0D%0AFrom: "+document.title+"%0D%0A"+e,jQuery(this).attr("href","mailto:?subject="+o.subject+"&body="+o.body),n.hide(),n.updateShareCount(n.postId,t,"email"),!0},this.render=function(){var t='<div class="selectionSharer" id="selectionSharerPopover" style="position:absolute;">  <div id="selectionSharerPopover-inner">    <ul>      <li><a class="action tweet" href="" title="Share this selection on Twitter" target="_blank">Tweet</a></li>      <li><a class="action facebook" href="" title="Share this selection on Facebook" target="_blank">Facebook</a></li>      <li><a class="action linkedin" href="" title="Share this selection on LinkedIn" target="_blank">LinkedIn</a></li>      <li><a class="action email" href="" title="Share this selection by email" target="_blank"><svg width="20" height="20"><path stroke="#FFF" stroke-width="6" d="m16,25h82v60H16zl37,37q4,3 8,0l37-37M16,85l30-30m22,0 30,30"/></svg></a></li>    </ul>  </div>  <div class="selectionSharerPopover-clip"><span class="selectionSharerPopover-arrow"></span></div></div>';n.$popover=e(t),n.$popover.find("a.tweet").click(n.shareTwitter),n.$popover.find("a.facebook").click(n.shareFacebook),n.$popover.find("a.linkedin").click(n.shareLinkedIn),n.$popover.find("a.email").click(n.shareEmail),e("body").append(n.$popover),n.appId&&n.url2share&&e(".selectionSharer a.facebook").css("display","inline-block")},this.setElements=function(t){"string"==typeof t&&(t=e(t)),n.$elements=t instanceof e?t:e(t),n.$elements.mouseup(n.show).mousedown(n.hide).addClass("selectionShareable"),n.$elements.bind("touchstart",function(){n.isMobile=!0}),document.onselectionchange=n.selectionChanged},this.selectionChanged=function(e){n.isMobile&&(n.lastSelectionChanged&&clearTimeout(n.lastSelectionChanged),n.lastSelectionChanged=setTimeout(function(){n.showPopunder(e)},300))},this.render(),t.elements&&this.setElements(t.elements)};e.fn.justtext=function(){return e(this).clone().children().remove().end().text()},e.fn.selectionSharer=function(){var e=new t;return e.setElements(this),this},e.fn.selectionSharerHide=function(e){e.e.hide()},e.fn.selectionSharerShow=function(e){e.sharer.text=e.text,e.sharer.show_text(e.e)},"function"==typeof define?define(function(){return t.load=function(e,n,o){var a=new t;a.setElements("p"),o()},t}):window.SelectionSharer=t}(jQuery),jQuery(document).ready(function(e){var t=new SelectionSharer("p");e.ajax({url:inboundrocket_ss_js.ajaxurl,type:"post",async:!1,dataType:"json",data:{nonce:inboundrocket_ss_js.nextNonce,action:"selection_sharer_gettext"},success:function(t){e.each(t,function(t,n){e('*:contains("'+n.share+'")').each(function(){e(this).children().length<1&&e(this).html(e(this).text().replace(n.share,'<span class="shared" data-id="'+n.share_id+'" data-text="'+n.share+'">'+n.share+'<span class="sharedSharesTwitter">'+n.twcount+'</span><span class="sharedSharesFacebook">'+n.fbcount+'</span><span class="sharedSharesLinkedIn">'+n.licount+'</span><span class="sharedSharesEmail">'+n.emcount+"</span></span>"))})})}}),e(".shared").on("click",function(n){$options={e:n,sharer:t,id:e(this).data("id"),text:e(this).data("text")},e(this).selectionSharerShow($options)})});