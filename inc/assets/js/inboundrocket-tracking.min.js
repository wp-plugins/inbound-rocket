"use strict"
function inboundrocket_check_merged_contact(e){jQuery.ajax({type:"POST",url:ir_ajax.ajax_url,data:{action:"inboundrocket_check_merged_contact",ir_id:e},success:function(e){var r=jQuery.parseJSON(e)
r&&jQuery.cookie("ir_hash",r,{path:"/",domain:""})},error:function(){}})}function inboundrocket_check_submission(e){var r=e.cookie("ir_submission")
if(r&&0!=r.length){var o=JSON.parse(r)
inboundrocket_insert_form_submission(o.submission_hash,o.hashkey,o.page_title,o.page_url,o.json_form_fields,o.lead_email,o.lead_first_name,o.lead_last_name,o.lead_phone,o.form_selector_id,o.form_selector_classes,function(){e.removeCookie("ir_submission")})}}function inboundrocket_submit_form(e,r){inboundrocket_debug_mode&&(console.log("\nFUNCTION FIRED: inboundrocket_submit_form()"),console.log("FIELDS:\n-----------\n"))
var o=e,i=[],n="",t="",a="",s="",d=e.attr("id")?e.attr("id"):"",l=e.classes()?e.classes().join(","):""
o.find('input[type!="submit"], textarea').not('input[type="hidden"], input[type="radio"], input[type="password"]').each(function(){var e=r(this),d=e.val()
if(!e.is(":visible"))return!0
var l=r("label[for='"+e.attr("id")+"']").text()
if(0==l.length&&r("#"+e.attr("id")+"_label").length&&(l=r("#"+e.attr("id")+"_label").text()),0==l.length&&(l=e.prev("label").not(".ir_used").addClass("ir_used").first().text(),l.length||(l=e.prevAll("b, strong, span").text())),0==l.length&&(l=e.next("label").not(".ir_used").addClass("ir_used").first().text(),l.length||(l=e.nextAll("b, strong, span").text())),0==l.length&&(l=e.parent().find("label, b, strong").not(".ir_used").first().text()),0==l.length&&r.contains(o,e.parent().parent())&&(l=e.parent().parent().find("label, b, strong").first().text()),0==l.length){var c=e.closest("p").not(".ir_used").addClass("ir_used")
c.length&&(l=c.text(),l=r.trim(l.replace(d,"")))}0==l.length&&void 0!==e.attr("placeholder")&&(l=""+e.attr("placeholder")),0==l.length&&void 0!==e.attr("name")&&(l=""+e.attr("name")),e.is(":checkbox")&&(d=e.is(":checked")?"Checked":"Not checked"),d=d.replace("C:\\fakepath\\","")
var u=r.trim(l.replaceArray(["(",")","required","Required","*",":"],[""])),_=u.toLowerCase()
ignore_field(u,d)?inboundrocket_debug_mode&&console.log("   - Skipping... label: "+l+" value: "+d):push_form_field(u,d,i),-1!=d.indexOf("@")&&-1!=d.indexOf(".")&&(n=d),t||("inboundrocket-subscribe-fname"==e.attr("id")?t=d:("first"==_||"first name"==_||"name"==_||"your name"==_)&&(t=d)),a||("inboundrocket-subscribe-lname"==e.attr("id")?a=d:("last"==_||"last name"==_||"your last name"==_||"surname"==_)&&(a=d)),s||("inboundrocket-subscribe-phone"==e.attr("id")?s=d:("phone"==_||"phone number"==_)&&(s=d))})
var c=[],u=[]
o.find(":radio").each(function(){-1==r.inArray(this.name,c)&&c.push(this.name),u.push(r(this).val())})
for(var _=0;_<c.length;_++){var f=r("input:radio[name='"+c[_]+"']")
r("input:radio[name='"+c[_]+"']:checked").val()
o.find(".gfield").length?$p=f.closest(".gfield").not(".ir_used").addClass("ir_used"):o.find(".frm_form_field").length?$p=f.closest(".frm_form_field").not(".ir_used").addClass("ir_used"):$p=f.closest("div, p").not(".ir_used").addClass("ir_used"),$p.length&&($rbg_label=$p.text(),$rbg_label=r.trim($rbg_label.replaceArray(u,[""]).replace($p.find(".gfield_description").text(),"")))
var m=r("input:radio[name='"+c[_]+"']:checked").val()?r("input:radio[name='"+c[_]+"']:checked").val():"not selected"
ignore_field($rbg_label,m)?inboundrocket_debug_mode&&console.log("Skipping... label: "+$label+" value: "+$value):push_form_field($rbg_label,m,i)}if(o.find("select").each(function(){var e=r(this),n=r("label[for='"+e.attr("id")+"']").text()
if(!n.length){var t=[]
e.find("option").each(function(){-1==r.inArray(r(this).val(),t)&&t.push(r(this).val())}),$p=e.closest("div, p").not(".ir_used").addClass("ir_used"),o.find(".gfield").length?$p=e.closest(".gfield").not(".ir_used").addClass("ir_used"):$p=e.closest("div, p").addClass("ir_used"),$p.length&&(n=$p.text(),n=r.trim(n.replaceArray(t,[""]).replace($p.find(".gfield_description").text(),"")))}var a=""
if(e.val()instanceof Array){var s=e.val()
for(_=0;_<s.length;_++)a+=s[_],_!=s.length-1&&(a+=", ")}else a=e.find("option:selected").text()?e.find("option:selected").text():e.val()
ignore_field(n,a)?inboundrocket_debug_mode&&console.log("Skipping... label: "+$label+" value: "+$value):push_form_field(n,a,i)}),o.find(".ir_used").removeClass("ir_used"),n){inboundrocket_debug_mode&&console.log("\nFOUND lead_email: "+n+"\n"),ignore_form&&push_form_field("Credit card form submitted","Payment fields not collected for security",i)
var p=Math.random().toString(36).slice(2),g=r.cookie("ir_hash"),h=JSON.stringify(i),b={}
b={submission_hash:p,hashkey:g,lead_email:n,lead_first_name:t,lead_last_name:a,lead_phone:s,page_title:page_title,page_url:page_url,json_form_fields:h,form_selector_id:d,form_selector_classes:l},inboundrocket_debug_mode&&(console.log("\nFORM SUBMISSION OBJECT:"),console.log(b)),r.cookie("ir_submission",JSON.stringify(b),{path:"/",domain:""}),inboundrocket_insert_form_submission(p,g,page_title,page_url,h,n,t,a,s,d,l,function(){r.removeCookie("ir_submission")}),inboundrocket_debug_mode&&(console.log("\nFORM SUBMISSION SUCCESS"),console.log(r.cookie("ir_submission")))}else form_saved=!0,inboundrocket_debug_mode&&console.log("ERROR: lead_email not found\n")}function inboundrocket_insert_form_submission(e,r,o,i,n,t,a,s,d,l,c,u){inboundrocket_debug_mode&&console.log("\nFUNCTION FIRED: inboundrocket_insert_form_submission()"),jQuery.ajax({type:"POST",url:ir_ajax.ajax_url,data:{action:"inboundrocket_insert_form_submission",ir_nonce:ir_ajax.ir_nonce,ir_submission_id:e,ir_id:r,ir_title:o,ir_url:i,ir_fields:n,ir_email:t,ir_first_name:a,ir_last_name:s,ir_phone:d,ir_form_selector_id:l,ir_form_selector_classes:c},success:function(e){inboundrocket_debug_mode&&console.log("RESULT rows updated: "+e),u&&u(e)},error:function(e){inboundrocket_debug_mode&&(console.log("Form Submission Failed:"),console.log(e))}})}function inboundrocket_insert_lead(e,r){jQuery.ajax({type:"POST",url:ir_ajax.ajax_url,data:{action:"inboundrocket_insert_lead",ir_nonce:ir_ajax.ir_nonce,ir_id:e,ir_referrer:r},success:function(e){inboundrocket_debug_mode&&console.log("Lead Insert: "+e)},error:function(){}})}function inboundrocket_log_pageview(e,r,o,i,n){jQuery.ajax({type:"POST",url:ir_ajax.ajax_url,data:{action:"inboundrocket_log_pageview",ir_nonce:ir_ajax.ir_nonce,ir_id:e,ir_title:r,ir_url:o,ir_referrer:i,ir_last_visit:n},success:function(e){inboundrocket_debug_mode&&console.log("Log Pageview: "+e)},error:function(){}})}function inboundrocket_check_visitor_status(e,r){jQuery.ajax({type:"POST",url:ir_ajax.ajax_url,data:{action:"inboundrocket_check_visitor_status",ir_nonce:ir_ajax.ir_nonce,ir_id:e},success:function(e){var o=jQuery.parseJSON(e)
r&&r(o)},error:function(){}})}function push_form_field(e,r,o){var i={label:e,value:r}
o.push(i),inboundrocket_debug_mode&&console.log("   + Adding... [label:] "+e+" [value:] "+r)}function ignore_field(e,r){var o=!1;(-1!=e.toLowerCase().indexOf("credit card")||-1!=e.toLowerCase().indexOf("card number"))&&(o=!0),(-1!=e.toLowerCase().indexOf("expiration")||-1!=e.toLowerCase().indexOf("expiry"))&&(o=!0),("month"==e.toLowerCase()||"mm"==e.toLowerCase()||"yy"==e.toLowerCase()||"yyyy"==e.toLowerCase()||"year"==e.toLowerCase())&&(o=!0),(-1!=e.toLowerCase().indexOf("cvv")||-1!=e.toLowerCase().indexOf("cvc")||-1!=e.toLowerCase().indexOf("secure code")||-1!=e.toLowerCase().indexOf("security code"))&&(o=!0),("visa"==r.toLowerCase()||"mastercard"==r.toLowerCase()||"american express"==r.toLowerCase()||"amex"==r.toLowerCase()||"discover"==r.toLowerCase())&&(o=!0)
var i=RegExp("/^[0-9]+$/")
if(i.test(r)){var n=r.replace(" ","")
isInt(n)&&n.length>=16&&(o=!0)}return e.length>250&&(o=!0),o?(ignore_form||(ignore_form=!0),!0):!1}function isInt(e){return"number"==typeof e&&isFinite(e)&&e%1===0}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function r(e){return s.raw?e:encodeURIComponent(e)}function o(e){return s.raw?e:decodeURIComponent(e)}function i(e){return r(s.json?JSON.stringify(e):e+"")}function n(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"))
try{return e=decodeURIComponent(e.replace(a," ")),s.json?JSON.parse(e):e}catch(r){}}function t(r,o){var i=s.raw?r:n(r)
return e.isFunction(o)?o(i):i}var a=/\+/g,s=e.cookie=function(n,a,d){if(arguments.length>1&&!e.isFunction(a)){if(d=e.extend({},s.defaults,d),"number"==typeof d.expires){var l=d.expires,c=d.expires=new Date
c.setMilliseconds(c.getMilliseconds()+864e5*l)}return document.cookie=r(n)+"="+i(a)+(d.expires?"; expires="+d.expires.toUTCString():"")+(d.path?"; path="+d.path:"")+(d.domain?"; domain="+d.domain:"")+(d.secure?"; secure":"")}for(var u=n?void 0:{},_=document.cookie?document.cookie.split("; "):[],f=_.length,m=0;f>m;m++){var p=_[m].split("="),g=o(p.shift()),h=p.join("=")
if(n===g){u=t(h,a)
break}n||void 0===(h=t(h))||(u[g]=h)}return u}
s.defaults={},e.removeCookie=function(r,o){return e.cookie(r,"",e.extend({},o,{expires:-1})),!e.cookie(r)}})
var page_title=jQuery(document).find("title").text(),page_url=window.location.href,page_referrer=document.referrer,form_saved=!1,ignore_form=!1,hashkey,ir_last_visit,inboundrocket_debug_mode=!0,ec=new evercookie
!function(){jQuery(document).ready(function(e){ec.get("ir_hash",function(r){r&&"<!DOCTYPE html>"!=r&&0!=r.length?(hashkey=r,inboundrocket_debug_mode&&console.log("Hashkey Exists: "+hashkey),inboundrocket_debug_mode&&console.log("\nFUNCTION FIRED: inboundrocket_insert_lead()"),inboundrocket_insert_lead(hashkey,page_referrer),inboundrocket_log_pageview(hashkey,page_title,page_url,page_referrer,e.cookie("ir_last_visit"))):(hashkey=Math.random().toString(36).slice(2),ec.set("ir_hash",hashkey),inboundrocket_debug_mode&&console.log("New Hashkey: "+hashkey),inboundrocket_debug_mode&&console.log("\nFUNCTION FIRED: inboundrocket_insert_lead()"),inboundrocket_insert_lead(hashkey,page_referrer),inboundrocket_log_pageview(hashkey,page_title,page_url,page_referrer,e.cookie("ir_last_visit")))}),-1!=e.versioncompare(e.fn.jquery,"1.7.0")?e("form").on("submit",function(){if(!("welcome_bar-form"==e(this).attr("id")||"mwelcome_bar-form"==e(this).attr("id")||"loginform"==e(this).attr("id")&&-1!=e(this).attr("action").indexOf("wp-login.php")||"lostpasswordform"==e(this).attr("id")&&-1!=e(this).attr("action").indexOf("wp-login.php"))){var r=e(this)
inboundrocket_submit_form(r,e)}}):e("form").bind("submit",function(){if(!("welcome_bar-form"==e(this).attr("id")||"mwelcome_bar-form"==e(this).attr("id")||"loginform"==e(this).attr("id")&&-1!=e(this).attr("action").indexOf("wp-login.php")||"lostpasswordform"==e(this).attr("id")&&-1!=e(this).attr("action").indexOf("wp-login.php"))){var r=e(this)
inboundrocket_submit_form(r,e)}})
var r=new Date,o=r.getTime()
r.setTime(r.getTime()+36e5),e.cookie("ir_last_visit")||inboundrocket_check_merged_contact(hashkey),e.cookie("ir_last_visit",o,{path:"/",domain:"",expires:r})})}(jQuery),String.prototype.replaceArray=function(e,r){for(var o=this,i=0;i<e.length;i++)o=1!=r.length?o.replace(e[i],r[i]):o.replace(e[i],r[0])
return o},function(e){function r(r){return e.map(r.split("."),function(e){return parseInt(e,10)})}e.versioncompare=function(o,i){if(void 0===o)throw Error("$.versioncompare needs at least one parameter.")
if(i=i||e.fn.jquery,o==i)return 0
for(var n=r(o),t=r(i),a=Math.max(n.length,t.length),s=0;a>s;s++)if(n[s]=n[s]||0,t[s]=t[s]||0,n[s]!=t[s])return n[s]>t[s]?1:-1
return 0}}(jQuery),function(e){e.fn.classes=function(r){var o=[]
if(e.each(this,function(e,r){var i=r.className.split(/\s+/)
for(var n in i){var t=i[n];-1===o.indexOf(t)&&o.push(t)}}),"function"==typeof r)for(var i in o)r(o[i])
return o}}(jQuery)